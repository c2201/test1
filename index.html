<!DOCTYPE html>
<html>
<head>
    <title>ä¸­è€ƒå€’è®¡æ—¶ - C2201|ä¸­è€ƒå¿…èƒœ</title>
    <meta charset="utf-8">
    <script src="js/solarterms.js"></script>
    <script src="js/timetable.js"></script>
    <script src="js/schedule.js"></script>
    <script src="js/phrases.js"></script>
    


    <style>
        @font-face {
            font-family: 'Ximai';
            src: url('fonts/1.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* åº•éƒ¨æŒ‰é’®æ ·å¼ */
        .action-buttons {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 10;
        }

        .action-button {
            width: auto;
            padding: 0 20px;
            height: 40px;
            border-radius: 20px;
            background: #8bc34a;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            color: white;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .action-button:hover {
            transform: scale(1.05);
        }

        /* æ›´æ–°æ—¥å¿—æ ·å¼ */
        .changelog-modal .settings-content {
            max-width: 600px;
            height: 75%;
        }

        .text-content {
            padding: 15px;
            white-space: pre-wrap;
            overflow-y: auto;
            height: calc(100% - 50px);
        }

        /* è®¾ç½®æ ·å¼ */
        .settings-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #8bc34a;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transition: transform 0.3s;
        }

        .settings-button:hover {
            transform: translateX(-50%) scale(1.1);
        }

        .settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 999;
        }

        .settings-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .settings-content {
            background: white;
            width: 60%;
            height: 75%;
            border-radius: 12px;
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.3s;
            position: relative;
            padding: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .settings-modal.active .settings-content {
            transform: scale(1);
            opacity: 1;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .settings-header h3 {
            margin: 0;
            font-size: 24px;
            color: #333;
        }

        .settings-body {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
            overflow-y: auto;
            height: calc(100% - 60px);
        }

        /* æ¨¡æ€æ¡†å…³é—­æŒ‰é’®æ ·å¼ */
        .close-btn {
            font-size: 28px;
            cursor: pointer;
            padding: 0 10px;
            color: #666;
        }

        .close-btn:hover {
            color: #333;
        }

        /* èŠ‚æ°”å¡ç‰‡æ ·å¼ */
        .solar-card {
            position: absolute;
            top: calc(100% + 20px);
            left: 50%;
            transform: translateX(-50%);
            width: 500px;
            background: rgba(255,255,255,0.96);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .solar-card::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 10px solid transparent;
            border-bottom-color: rgba(255,255,255,0.96);
        }

        .solar-card.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        .solar-card h3 {
            text-align: center;
            margin: 0 0 15px;
            font-size: 24px;
            color: #1b5e20;
            font-family: STZhongsong, serif;
        }

        .solar-card img {
            width: 160px;
            height: 140px;
            object-fit: cover;
            border-radius: 8px;
        }

        .solar-card p {
            font-size: 16px;
            line-height: 1.6;
            color: #444;
            margin: 0;
            font-family: 'Microsoft YaHei';
            flex-grow: 1;
            text-align: left;
            text-indent: 2em;
        }

        /.solar-term-marker {
            transition: all 0.3s ease;
        }

        .solar-card {
            transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
        }

        /* æ—¶é—´å®¹å™¨æ ·å¼ */
        #currentDateTime {
            position: absolute;
            top: 78px;
            left: 25px;
            z-index: 5;
            background: rgba(255,255,255,0.9);
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 180px;
        }

        /* å·¦ä¸Šè§’æ—¶é—´æ ·å¼ */
        .time-section {
            font-family: 'Microsoft-Yahei', sans-serif;
            font-size: 44px;
            letter-spacing: 0;
            color: #1b5e20;
            margin: 8px 0;
            display: block;
                width: 100%;
        }

        /* å·¦ä¸Šè§’æ—¥æœŸæ ·å¼ */
        .date-section {
            font-family: 'Microsoft YaHei', serif;
            font-size: 22px;
            color: #666;
            letter-spacing: 0.5px;
            white-space: nowrap;
            display: block;
            width: 100%;
        }

        /* é‡‘å¥æ ·å¼ */
        #goldenPhrase {
            text-align: center;
            margin: 10px auto;
            width: 760px;
            font-size: 26px;
            color: #1b5e20;
            min-height: 40px;
            font-family: STZhongSong, cursive;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            transition: opacity 0.5s;
            position: relative;
            top: -95px;
            margin-bottom: -45px;
        }

        /* åŸºç¡€æ ·å¼ */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(to bottom right, #f5fff5, #e8f5e9);
        }

        /* å¯¼èˆªæ æ ·å¼ */
        .navbar {
            background-color: #333;
            overflow: hidden;
            width: 100%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: relative;
            z-index: 6;
        }

        .brand {
            float: left;
            color: white;
            padding: 14px 20px;
            font-size: 20px;
            font-weight: bold;
            text-decoration: none;
            letter-spacing: 1px;
        }

        .navbar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 18px;
            text-decoration: none;
            font-size: 16px;
            transition: all 0.3s;
        }

        .navbar a:hover {
            background: #ddd;
            color: black;
        }

        /* ä¸­è€ƒå€’è®¡æ—¶æ ·å¼ */
        .small-title {
            text-align: center;
            color: #2d2d2d;
            font-size: 38px;
            font-family: STZhongsong, serif;
            margin-top: 50px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .big-title {
            text-align: center;
            color: #1b5e20;
            font-size: 160px;
            font-family: STKaiti;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* æ—¶é—´è½´æ ·å¼ */ 
        .timeline-container {
            max-width: 750px;
            margin: 50px auto;
            position: relative;
            height: 120px;
            overflow: visible;
        }

        .timeline-progress {
            height: 8px;
            background: linear-gradient(
                to right,
                #8bc34a 0%,
                #8bc34a var(--progress-percent),
                #e0e0e0 var(--progress-percent),
                #e0e0e0 100%
            );
            border-radius: 4px;
            position: relative;
            margin-top: 60px;
        }

        /* èŠ‚æ°”æ ‡è®°æ ·å¼ */
        .solar-term-marker {
            position: absolute;
            top: -45px;
            width: 70px;
            text-align: center;
            transform: translateX(-50%);
            cursor: pointer;
            transition: all 0.3s;
            z-index: 2;
        }

        .current-marker {
            position: absolute;
            left: 0;
            top: -10px;
            width: 3px;
            height: 30px;
            background: #ff5722;
            transform: translateX(-50%);
            transition: left 0.5s ease-out;
            box-shadow: 0 2px 4px rgba(255,87,34,0.3);
        }

        /* ä¸­è€ƒæ—¥æ ‡è®°æ ·å¼ */
        .end-marker {
            position: absolute;
            right: -15px;
            top: -45px;
            width: 90px;
            text-align: center;
            color: #d32f2f;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(211,47,47,0.2);
            transform: translateX(30%);
        }

        /* ä½œæ¯æç¤ºæ ·å¼ */
        .schedule-container {
            position: absolute;
            top: 225px;
            left: 25px;
            z-index: 5;
            background: rgba(255,255,255,0.9);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-width: 190px;
        }

        .schedule-item {
            font-family: 'STZhongSong', sans-serif;
            margin: 8px 0;
        }

        .schedule-title {
            display: block;
            font-size: 20px;
            color: #1b5e20;
            font-weight: 600;
            text-align: left;
            line-height: 0.8;
        }

        .schedule-value {
            display: block;
            font-size: 25px;
            color: #2d2d2d;
            text-align: center;
            margin: 4px 0 0;
            padding: 2px 0;
            line-height: 0.8;
        }

        /* è¯¾è¡¨æ ·å¼ */
        .timetable {
            margin-top: 10px;
            border-top: 1px solid #eee;
            padding-top: 8px;
        }

        .timetable-item {
            font-size: 25px;
            font-family: STZhongSong, cursive;
            line-height: 1.2;
            text-align: center;
        }

        /* æ¯æ—¥60sæ ·å¼ */
        .right-image-container {
            position: fixed;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 5;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .right-image-container img {
            height: 80vh;
            object-fit: cover;
            display: block;
            margin: 0 auto;
        }

        /* æ»‘å—å¼€å…³æ ·å¼ */
        input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .switch-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .switch {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .slider {
            position: relative;
            cursor: pointer;
            width: 40px;
            height: 24px;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 24px;
        }

        .switch-text {
            font-size: 14px;
            color: #1b5e20;
            display: inline-block;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #8bc34a;
        }

        input:checked + .slider:before {
            transform: translateX(16px);
        }

        input:checked ~ .switch-text {
            color: #4CAF50;
        }

        /* å…¬å‘Šå¡ç‰‡æ ·å¼ */
        .announcement-card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 15px;
            border: 1px solid #eee;
        }

        .announcement-title {
            font-size: 1.6em;
            color: #1b5e20;
            font-weight: 600;
            margin-bottom: 8px;
            border-bottom: 2px solid #8bc34a;
            padding-bottom: 5px;
            text-align: center;
        }

        .announcement-time {
            font-size: 0.95em;
            color: #666;
            margin-bottom: 15px;
            text-align: center;
        }

        .announcement-body {
            line-height: 1.2;
            color: #444;
            font-size: 1.2em;
        }

        .announcement-body ul {
            margin: 8px 0;
            padding-left: 25px;
        }

        .announcement-body li {
            margin: 6px 0;
        }

        .announcement-footnote {
            font-size: 0.85em;
            color: #999;
            margin-top: 15px;
            border-top: 1px dashed #ddd;
            padding-top: 10px;
        }

        .announcement-content {
            height: calc(100% - 60px);
            overflow-y: auto;
            padding: 0 10px;
        }

        .announcement-content::-webkit-scrollbar {
            width: 6px;
        }

        .announcement-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .announcement-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .announcement-content::-webkit-scrollbar-thumb:hover {
            background: #8bc34a;
        }

        /* æ¦‚ç‡æ§åˆ¶æ ·å¼ */
        .probability-control {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 100%;
            margin: 12px 0;
        }

        .probability-control .switch-text {
            flex: 1;
            font-size: 14px;
            color: #1b5e20;
        }

        .range-group {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 40%;
            justify-content: flex-end;
        }

        #apiProbability {
            width: 100%;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            -webkit-appearance: none;
            margin: 0 8px;
        }

        #apiProbability::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: none;
        }

        #apiProbability::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            border: none;
            cursor: pointer;
        }

        #apiProbabilityValue {
            width: 50px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
        }

        /* é—´éš”æ—¶é—´æ§åˆ¶æ ·å¼ */
        #intervalSlider {
            width: 100%;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            -webkit-appearance: none;
            margin: 0 8px;
        }

        #intervalSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: none;
        }

        #intervalSlider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            border: none;
            cursor: pointer;
        }

        #intervalValue {
            width: 50px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
        }

        /* é‡ç½®æŒ‰é’®æ ·å¼ */
        .reset-btn {
            padding: 5px 12px;
            min-width: 50px;
            white-space: nowrap;
            background: #8bc34a;
            border-radius: 4px;
            color: white;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .reset-btn:hover {
            background: #7cb342;
            transform: scale(1.05);
            box-shadow: none;
        }

        /* é‡‘å¥ç‚¹å‡»æ•ˆæœ */
        #goldenPhrase {
            cursor: pointer;
            transition: all 0.3s;
        }

        #goldenPhrase:active {
            transform: scale(0.98);
        }

        /* åŠ¨ç”»æ§åˆ¶æ ·å¼ */
        #goldenPhrase.no-animation {
            transition: none !important;
        }

        #goldenPhrase.no-animation:active {
            transform: none !important;
        }

        /* é‡‘å¥åˆ—è¡¨æ ·å¼ */
        #phraseList {
            padding: 15px;
            overflow-y: auto;
            height: calc(100% - 50px);
        }

        .phrase-item {
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
            background: #f8f8f8;
            cursor: pointer;
            transition: all 0.2s;
            font-family: STZhongSong, cursive;
            color: #1b5e20;
        }

        .phrase-item:hover {
            background: #e8f5e9;
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* é€‰æ‹©é‡‘å¥ç•Œé¢é‡‘å¥ç‚¹å‡»åŠ¨ç”» */
        .phrase-item {
            transition: all 0.3s ease;
        }

        .phrase-item:active {
            transform: scale(0.97);
            background: #e0f2f1 !important;
        }

        @keyframes phraseClickWave {
            0% { box-shadow: 0 0 0 0 rgba(139, 195, 74, 0.3); }
            100% { box-shadow: 0 0 0 10px rgba(139, 195, 74, 0); }
        }

        .phrase-click-effect {
            animation: phraseClickWave 0.4s ease-out;
            position: relative;
        }

        /* å¯»ç‰©æ¿ */
        .editable {
            cursor: pointer;
            transition: all 0.3s;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: STZhongsong, serif;
            color: #1E90FF;
            text-shadow: 0 0 2px rgba(0,0,0,0.2);
            border-bottom: 2px solid #FFD700; /* é‡‘è‰²ä¸‹åˆ’çº¿ */
        }

        .editable:hover {
            background: #f0f0f0;
        }

        .edit-input {
            width: 120px;
            padding: 5px;
            border: 2px solid #8bc34a;
            border-radius: 4px;
            font-size: 28px;
            text-align: center;
            color: #1E90FF;
            margin: 0 5px;
            font-family: STZhongsong, serif;
        }

        @keyframes gradient-pulse {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }

        .add-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8bc34a, #7cb342);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            /* æ·»åŠ é˜´å½±æ•ˆæœ */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25), 
                        0 0 0 2px rgba(255, 255, 255, 0.8) inset;
            transition: all 0.3s ease;
            z-index: 999;
            font-size: 24px;
            font-weight: bold;
            animation: button-pulse 2s infinite;
        }

        /* æ‚¬åœæ•ˆæœ - æ”¾å¤§å’Œå¢å¼ºé˜´å½± */
        .add-button:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3),
                        0 0 0 2px rgba(255, 255, 255, 0.9) inset;
        }

        /* ç‚¹å‡»åŠ¨ç”» - ç¼©å°æ•ˆæœ */
        .add-button:active {
            transform: scale(0.85);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2),
                        0 0 0 3px rgba(255, 255, 255, 0.8) inset;
            background: linear-gradient(135deg, #7cb342, #689f38);
        }

        /* æ·»åŠ æŒ‰é’®çš„å‘å…‰åŠ¨ç”» */
        @keyframes button-pulse {
            0% { box-shadow: 0 0 0 0 rgba(139, 195, 74, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(139, 195, 74, 0); }
            100% { box-shadow: 0 0 0 0 rgba(139, 195, 74, 0); }
        }

        .delete-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            padding: 4px 12px;
            border-radius: 15px;
            background: #ff4444;
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        #lostAndFoundList .announcement-card {
            padding: 12px;
            margin: 8px 10px;
        }

        #lostAndFoundList .announcement-body {
            line-height: 1.1;
        }

        #lostAndFoundList .editable {
            margin: 1px 0;
            padding: 2px 4px;
        }

        /* é€šçŸ¥æ ·å¼ */
        .notification-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            font-family: STZhongsong, serif;
        }
        
        #notificationContent {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            transition: font-size 0.3s ease;
            max-height: calc(100% - 70px);
        }
        
        .notification-item {
            position: relative;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 40px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            font-family: inherit;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .notification-item:hover {
            background: #e8f5e9;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        
        .notification-editable {
            width: 100%;
            min-height: 60px;
            padding: 10px;
            border: 2px solid #8bc34a;
            border-radius: 4px;
            font-size: inherit;
            box-sizing: border-box;
            font-family: inherit;
            resize: vertical;
            line-height: 1.5;
        }
        
        .notification-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-top: 1px solid #eee;
            margin-top: 10px;
            position: sticky;
            bottom: 0;
            background: white;
            z-index: 10;
            flex-shrink: 0;
        }
        
        .font-size-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .font-size-label {
            font-size: 14px;
            color: #1b5e20;
            font-family: STZhongsong, serif;
        }
        
        #fontSizeSlider {
            width: 150px;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            -webkit-appearance: none;
        }
        
        #fontSizeSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
        
        #fontSizeSlider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            border: none;
            cursor: pointer;
        }
        
        #fontSizeValue {
            width: 50px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
            font-family: inherit;
        }
        
        .add-notification-btn {
            padding: 8px 15px;
            background: #8bc34a;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: STZhongsong, serif;
            font-size: 15px;
        }
        
        .add-notification-btn:hover {
            background: #7cb342;
            transform: scale(1.05);
        }
        
        .delete-notification-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            padding: 4px 12px;
            border-radius: 15px;
            background: #ff4444;
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            font-family: STZhongsong, serif;
            font-size: 14px;
        }
        
        .empty-notification {
            text-align: center;
            padding: 30px;
            color: #999;
            font-style: italic;
        }

        /* æœ€å¤§åŒ–æŒ‰é’®æ ·å¼ */
        .maximize-btn {
            cursor: pointer;
            font-size: 24px;
            padding: 0 10px;
            color: #666;
            transition: all 0.3s;
            position: relative;
            z-index: 100;
        }

        .maximize-btn:hover {
            color: #333;
            transform: scale(1.1);
        }

        /* å…¨å±æ¨¡æ€æ¡†æ ·å¼ */
        .settings-modal.fullscreen .settings-content {
            width: 100%;
            height: 100%;
            max-width: none;
            max-height: none;
            border-radius: 0;
        }

        /* å¹³æ»‘è¿‡æ¸¡åŠ¨ç”» */
        .settings-content {
            transition: all 0.3s ease;
        }

        /* ç»Ÿä¸€çš„æ»‘åŠ¨æ¡æ ·å¼ */
        #fontSizeSlider, #lostAndFoundFontSizeSlider {
            width: 150px;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            -webkit-appearance: none;
            margin: 0 8px;
        }
        
        #fontSizeSlider::-webkit-slider-thumb, 
        #lostAndFoundFontSizeSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
        
        #fontSizeSlider::-moz-range-thumb, 
        #lostAndFoundFontSizeSlider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #8bc34a;
            border-radius: 50%;
            border: none;
            cursor: pointer;
        }
    </style>



</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <header>
        <nav class="navbar">
            <div class="brand">C2201</div>
            <a href="https://c2201.github.io/">é¦–é¡µ</a>
            <a href="https://c2201.github.io/countdown/">æ–°&nbsp;Â·&nbsp;äºŒåå››èŠ‚æ°”ä¸­è€ƒå€’è®¡æ—¶</a>
            <!-- <a href="https://c2201.github.io/wheel/">è½¬ç›˜</a> -->
        </nav>
    </header>
 
    <!-- æ—¶é’Ÿ -->
    <div id="currentDateTime">
        <div class="time-section"></div>
        <div class="date-section"></div>
    </div>

    <!-- ä½œæ¯æç¤ºå®¹å™¨ -->
    <div id="scheduleContainer" class="schedule-container">
        <div class="schedule-item">
            <span class="schedule-title">å¤©æ°”ï¼š</span>
            <span class="schedule-value" id="weatherInfo">åŠ è½½ä¸­...</span>
        </div>
        <div class="schedule-item">
            <span class="schedule-title">å½“å‰ï¼š</span>
            <span class="schedule-value" id="currentSchedule">åŠ è½½ä¸­...</span>
        </div>
        <div class="schedule-item">
            <span class="schedule-title">ä¸‹èŠ‚è¯¾ï¼š</span>
            <span class="schedule-value" id="nextSchedule">åŠ è½½ä¸­...</span>
        </div>
        <div class="schedule-item">
            <span class="schedule-title" id="countdownName">å€’è®¡æ—¶ï¼š</span>
            <span class="schedule-value" id="countdownTimer" style="font-size: 28px;">--:--</span>
        </div>
        <div class="timetable" id="todayTimetable"></div>
    </div>
 
    <!-- ä¸­è€ƒå€’è®¡æ—¶ -->
    <div class="small-title">è·ç¦»2025å¹´ä¸­è€ƒä»…å‰©</div>
    <div id="daysUntil" class="big-title"></div>
 
    <!-- æ—¶é—´è½´ -->
    <div class="timeline-container">
        <div class="timeline-progress" id="timeline">
            <div class="end-marker">
                <div style="white-space: nowrap;">ä¸­è€ƒæ—¥</div>
                <div style="font-size:0.9em; margin-top:3px">6æœˆ18æ—¥</div>
            </div>
        </div>
    </div>
 
    <!-- é‡‘å¥ -->
    <div id="goldenPhrase"></div>

    <!-- æ¯æ—¥60s -->
    <div class="right-image-container">
        <img id="apiImage" src="" alt="æ¯æ—¥60s">
    </div>

    <!-- åº•éƒ¨æŒ‰é’® -->
    <div class="action-buttons">
        <button id="settingsButton" class="action-button">âš™ï¸ è®¾ç½®</button>
        <button id="changelogButton" class="action-button">ğŸ“ æ›´æ–°æ—¥å¿—</button>
        <button id="announcementButton" class="action-button">ğŸ“¢ å…¬å‘Š</button>
        <button id="phraseSelectButton" class="action-button">ğŸ“œ é€‰æ‹©é‡‘å¥</button>
        <button id="lostAndFoundButton" class="action-button">ğŸ” å¯»ç‰©</button>
        <button id="notificationButton" class="action-button">ğŸ”” é€šçŸ¥</button>
    </div>

    <!-- è®¾ç½®æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>è®¾ç½®</h3>
                <span class="close-btn" id="closeSettings">&times;</span>
            </div>
            <div class="settings-body">
                <div class="switch-container">
                    <label class="switch">
                        <span class="switch-text">é‡‘å¥è‡ªåŠ¨è½®æ’­</span>
                        <input type="checkbox" id="goldenSwitch" checked>
                        <span class="slider"></span>
                    </label>
                    <label class="switch">
                        <span class="switch-text">æ˜¾ç¤ºæ¯æ—¥60s</span>
                        <input type="checkbox" id="imageSwitch">
                        <span class="slider"></span>
                    </label>
                    <div class="probability-control">
                        <span class="switch-text">è”ç½‘è·å–é‡‘å¥çš„æ¦‚ç‡(%)</span>
                        <div class="range-group">
                            <input type="range" id="apiProbability" min="0" max="100" value="50">
                            <input type="number" id="apiProbabilityValue" min="0" max="100" value="50">
                            <button class="reset-btn" onclick="resetProbability()">é‡ç½®</button>
                        </div>
                    </div>
                    <div class="probability-control">
                        <span class="switch-text">é‡‘å¥è½®æ’­æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰</span>
                        <div class="range-group">
                            <input type="range" id="intervalSlider" min="1" max="60" value="15">
                            <input type="number" id="intervalValue" min="1" max="60" value="15">
                            <button class="reset-btn" onclick="resetInterval()">é‡ç½®</button>
                        </div>
                    </div>
                    <label class="switch">
                        <span class="switch-text">å¯ç”¨ç‚¹å‡»åˆ·æ–°é‡‘å¥</span>
                        <input type="checkbox" id="clickRefreshSwitch">
                        <span class="slider"></span>
                    </label>
                    <label class="switch">
                        <span class="switch-text">å¼€å¯é‡‘å¥åŠ¨ç”»æ•ˆæœ</span>
                        <input type="checkbox" id="animationSwitch" checked>
                        <span class="slider"></span>
                    </label>
                    <label class="switch">
                        <span class="switch-text">æœ¬åœ°é‡‘å¥åªå±•ç¤ºåŸåˆ›</span>
                        <input type="checkbox" id="originalSwitch">
                        <span class="slider"></span>
                    </label>
                    <label class="switch">
                        <span class="switch-text">è‡ªåŠ¨åˆ·æ–°é¡µé¢</span>
                        <input type="checkbox" id="autoRefreshSwitch" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- æ›´æ–°æ—¥å¿—æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="changelogModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>æ›´æ–°æ—¥å¿—</h3>
                <span class="close-btn" id="closeChangelog">&times;</span>
            </div>
            <div class="text-content" id="changelogContent">
                <strong># 20250607.1 æ›´æ–°</strong>

                â€¢ å¢åŠ æ¯éš”15minè‡ªåŠ¨åˆ·æ–°é¡µé¢åŠŸèƒ½
                â€¢ ç¼©å°è®¾ç½®ç•Œé¢è®¾ç½®é¡¹é—´è·

                <strong># 20250531.4 æ›´æ–°</strong>

                â€¢ ç¾åŒ–å¯»ç‰©æ¿æ·»åŠ æŒ‰é’®

                <strong># 20250531.3 æ›´æ–°</strong>

                â€¢ å¯»ç‰©æ¿æ”¯æŒè°ƒæ•´å­—ä½“å¤§å°

                <strong># 20250531.2 æ›´æ–°</strong>

                â€¢ é€šçŸ¥æ¿å¼€å‘å®Œæ¯•
                â€¢ æ·»åŠ æ¨¡æ€æ¡†å…¨å±åŠŸèƒ½ï¼ˆä»…é™å¯»ç‰©ã€é€šçŸ¥æ¿ï¼‰
                â€¢ å°†å¯»ç‰©æ¿çš„â€œå¯»ç‰©â€å¤§å­—æ ‡é¢˜ä¸‹ç§»12px

                <strong># 20250531.1 æ›´æ–°</strong>

                â€¢ é‡‘å¥æ”¯æŒæ¢è¡Œ
                â€¢ é€‰æ‹©é‡‘å¥åç«‹åˆ»å…³é—­æ¨¡æ€æ¡†
                â€¢ é€šçŸ¥åŠŸèƒ½ï¼ˆå¼€å‘ä¸­ï¼Œæš‚ä¸å¯è§ï¼‰

                <strong># 20250524.4 æ›´æ–°</strong>

                â€¢ æ¢å¤å¯¼èˆªæ çš„æ‚¬åœæ•ˆæœ

                <strong># 20250524.3 æ›´æ–°</strong>

                â€¢ æ›´æ”¹éƒ¨åˆ†é‡‘å¥çš„æƒé‡

                <strong># 20250524.2 æ›´æ–°</strong>

                â€¢ åœ¨é€‰æ‹©é‡‘å¥åé‡ç½®å®šæ—¶å™¨

                <strong># 20250524.1 æ›´æ–°</strong>

                â€¢ æ–°å¢â€œæœ¬åœ°é‡‘å¥åªå±•ç¤ºåŸåˆ›â€åŠŸèƒ½
                â€¢ è®¾ç½®ç•Œé¢æ”¯æŒæ»šåŠ¨

                <strong># 20250504.2 æ›´æ–°</strong>

                â€¢ æ–°å¢ä¸‹è¯¾ï¼ˆä¸‹è€ƒ/ä¸‹æ™šè‡ªä¹ ç­‰ï¼‰å€’è®¡æ—¶

                <strong># 20250504.1 æ›´æ–°</strong>

                â€¢ è€ƒè™‘åˆ°å‘¨äº”è‹±è¯­è€ƒè¯•åªæœ‰100åˆ†é’Ÿï¼Œå°†å·¥ä½œæ—¥ä½œæ¯è¡¨æ‹†åˆ†ä¸ºå‘¨ä¸€åˆ°å‘¨å››ã€å‘¨äº”ä¸¤ä¸ªéƒ¨åˆ†ï¼Œè¿›è¡Œç‰¹æ®Šå¤„ç†

                <strong># 20250502.4 æ›´æ–°</strong>

                åŠŸèƒ½æ€§æ›´æ–°ï¼š
                    â€¢ ä¸ºé‡‘å¥æ–°å¢4ä¸ªAPIï¼š2ä¸ªå¤è¯—è¯APIã€1ä¸ªå”¯ç¾è¯­å¥APIã€1ä¸ªåå¥APIï¼Œå¹¶æ·»åŠ æƒé‡
                    â€¢ å°†é‡‘å¥æ˜¾ç¤ºåŒºåŸŸä¸Šç§»45px
                    â€¢ æ›´æ”¹ã€Šé£é¸Ÿé›†ã€‹è¯­å¥APIçš„æ˜¾ç¤ºæ ¼å¼ä¸ºâ€œè‹±æ–‡ï¼ˆä¸­æ–‡ï¼‰â€”â€”æ³°æˆˆå°”â€
                æŠ€æœ¯æ€§æ›´æ–°ï¼š
                    â€¢ åˆå°†20250502.1æ›´æ–°ä¸­æ›´æ”¹çš„â€œå°†csså’Œjsä»£ç æ”¾å…¥äº†å•ç‹¬çš„æ–‡ä»¶ä¸­â€æ”¹äº†å›æ¥ï¼Œå†æ¬¡å…¨éƒ¨å¡è¿›index.html

                <strong># 20250502.3 æ›´æ–°</strong>

                â€¢ ä¿®å¤äº†è‹¥å¹²ä¿®æ”¹è¯¾ç¨‹è¡¨ã€ä½œæ¯è¡¨åå¯¼è‡´çš„bug

                <strong># 20250502.2 æ›´æ–°</strong>

                â€¢ ä¿®æ”¹äº†éƒ¨åˆ†é‡‘å¥çš„å±•ç¤ºæ¦‚ç‡

                <strong># 20250502.1 æ›´æ–°</strong>

                åŠŸèƒ½æ€§æ›´æ–°ï¼š
                    â€¢ ä¿®æ”¹äº†è¯¾ç¨‹è¡¨å’Œä½œæ¯è¡¨
                    â€¢ å°†å¯»ç‰©æ¿ä¸­çš„åå­—å’Œç‰©å“æ”¹ä¸ºè“è‰²ï¼Œå¹¶å°†å­—å·è°ƒå¤§ä¸º28pxï¼ˆåŸ24pxï¼‰ï¼Œä¸”åœ¨ä¸‹æ–¹æ·»åŠ é‡‘è‰²ä¸‹åˆ’çº¿
                æŠ€æœ¯æ€§æ›´æ–°ï¼š
                    â€¢ ä¿®æ”¹äº†è·å–ã€å±•ç¤ºè¯¾ç¨‹è¡¨ã€ä½œæ¯è¡¨ç›¸å…³é€»è¾‘
                    â€¢ å°†csså’Œjsä»£ç æ”¾å…¥äº†å•ç‹¬çš„æ–‡ä»¶ä¸­

                <strong># 20250426.1 æ›´æ–°</strong>

                â€¢ æ–°å¢â€œå¯»ç‰©â€åŠŸèƒ½

                <strong># 20250322.2 æ›´æ–°</strong>

                â€¢ æ–°å¢â€œé‡‘å¥é€‰æ‹©â€åŠŸèƒ½

                <strong># 20250322.1 æ›´æ–°</strong>

                â€¢ æ–°å¢â€œå¼€å¯é‡‘å¥åŠ¨ç”»æ•ˆæœâ€å¼€å…³

                <strong># 20250315.1 æ›´æ–°</strong>

                åŠŸèƒ½æ€§æ›´æ–°ï¼š
                    â€¢ æ–°å¢ç‚¹å‡»åˆ·æ–°é‡‘å¥åŠŸèƒ½
                    â€¢ æ–°å¢â€œå¯ç”¨ç‚¹å‡»åˆ·æ–°é‡‘å¥â€å¼€å…³
                æŠ€æœ¯æ€§æ›´æ–°ï¼š
                    â€¢ å°†index.htmlä¸­JavaScriptéƒ¨åˆ†çš„â€œPart0 å„ç§æ•°æ®â€æ‹†åˆ†ä¸ºå•ç‹¬çš„jsæ–‡ä»¶

                <strong># 20250309.1 æ›´æ–°</strong>

                åŠŸèƒ½æ€§æ›´æ–°ï¼š
                    â€¢ è°ƒå¤§é‡‘å¥å’Œå·¦ä¾§ä½œæ¯æ˜¾ç¤ºã€è¯¾ç¨‹è¡¨çš„å­—ä½“
                æŠ€æœ¯æ€§æ›´æ–°ï¼š
                    â€¢ æ›´æ–°æ—¥å¿—å†…å®¹ä¸å†ä»æ–‡ä»¶è¯»å–ï¼Œè€Œæ˜¯ç›´æ¥æ·»åŠ åœ¨index.htmlä¸­

                <strong># 20250301.3 æ›´æ–°</strong>
                
                â€¢ ä¿®å¤å·²çŸ¥é—®é¢˜ï¼Œæå‡ç³»ç»Ÿç¨³å®šæ€§
                
                <strong># 20250301.2 æ›´æ–°</strong>
                
                åŠŸèƒ½æ€§æ›´æ–°ï¼š
                    â€¢ æ–°å¢"é‡‘å¥è½®æ’­æ—¶é—´é—´éš”"è®¾ç½®
                    â€¢ æ–°å¢"è”ç½‘è·å–é‡‘å¥çš„æ¦‚ç‡"è®¾ç½®
                    â€¢ ç»™é‡‘å¥æ·»åŠ äº†å‡ºå¤„æ˜¾ç¤º
                    â€¢ å°†æ‰€æœ‰æœ¬åœ°é‡‘å¥åº“ä¸­çš„é‡‘å¥åˆ†ä¸º3ä¸ªç­‰çº§ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„å±•ç¤ºæ¦‚ç‡
                æŠ€æœ¯æ€§æ›´æ–°ï¼š
                    â€¢ å…¬å‘Šæ¿å†…å®¹ä¸å†ä»æ–‡ä»¶è¯»å–ï¼Œè€Œæ˜¯ç›´æ¥æ·»åŠ åœ¨index.htmlä¸­
                
                <strong># 20250301.1 æ›´æ–°</strong>
                
                â€¢ æ›´æ–°äº†å…¬å‘Šæ¿
                
                <strong># 20250224.2 æ›´æ–°</strong>
                
                â€¢ æ›´æ–°äº†æ›´æ–°æ—¥å¿—
                
                <strong># 20250224.1 æ›´æ–°</strong>
                
                â€¢ æ›´æ–°äº†è®¾ç½®ä¸­å¿ƒ
            </div>
        </div>
    </div>

    <!-- å…¬å‘Šæ¿æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="announcementModal">
        <div class="settings-content">
            <div class="settings-header" style="padding-bottom: 8px;">
                <h3 style="font-size: 1.2em;">å…¬å‘Š</h3>
                <span class="close-btn" id="closeAnnouncement">&times;</span>
            </div>
            <div class="announcement-content">
                <div class="announcement-card">
                    <div class="announcement-title">ğŸ“¢ å€’è®¡æ—¶ç½‘ç«™å¾ç¨¿æ´»åŠ¨å¼€å§‹å•¦ï¼</div>
                    <div class="announcement-time">2025.3.1</div>
                    <div class="announcement-body">
                        C2201å€’è®¡æ—¶ç½‘ç«™åº•éƒ¨é‡‘å¥è½®æ’­å†…å®¹<strong>å¼€å§‹å¾ç¨¿äº†</strong>ï¼é€‰ä¸Šçš„ä½œå“å¯ä»¥æ”¾åœ¨ç½‘ç«™ä¸Š<strong>è½®æ’­å±•ç¤º</strong>ï¼
                        <ul>
                            <li><strong>å‚ä¸æ¡ä»¶ï¼š</strong>æ˜¯ä¸ªäººéƒ½èƒ½å‚åŠ </li>
                            <li><strong>æ—¶é—´ï¼š</strong>å³æ—¥èµ·è‡³2025å¹´5æœˆ31æ—¥ï¼ˆæ´»åŠ¨å·²ç»“æŸï¼‰</li>
                            <li><strong>å¾ç¨¿å†…å®¹ï¼š</strong><strong>åŠ±å¿—æ–‡å­—</strong>ã€ä¼˜ç¾<strong>ä½œæ–‡ç´ æ</strong>ã€<strong>è¯—æ­Œï¼ˆå«ç°ä»£è¯—ï¼‰</strong>æˆ–<strong>æ•´æ´»</strong>ï¼ˆ<strong>ä¸èƒ½å…«å¦</strong>ï¼‰ç­‰ï¼ˆç‰¹åˆ«åœ°ï¼Œæ—¢å¯ä»¥åŸåˆ›ï¼Œä¹Ÿå¯ä»¥æŠ•ä½ åœ¨å…¶ä»–åœ°æ–¹çœ‹åˆ°çš„å¾ˆå¥½çš„å¥å­ä¸Šæ¥ï¼Œä½†æ˜¯è¦<strong>æ ‡æ˜å‡ºå¤„</strong>ï¼›è‹¥æ˜¯åŸåˆ›å¥å­å¯é€‰æ‹©å±•ç¤ºæ—¶æ˜¯å¦æ˜¾ç¤ºç½²åï¼‰ï¼ˆä¸€ä¸ªå¥å­å±•ç¤ºçš„æ¦‚ç‡ï¼šåŠ±å¿—æ–‡å­— = ä¼˜ç¾ä½œæ–‡ç´ æ > æ•´æ´»ï¼Œå¯æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ï¼Œç‰¹åˆ«åœ°ï¼Œè‹¥åŸåˆ›å¥å­å†™çš„<strong>è¿‡äºç²¾å¦™</strong>ï¼Œå¯ä»¥<strong>æé«˜å±•ç¤ºæ¦‚ç‡</strong>ï¼‰</li>
                            <li><strong>å­—æ•°è¦æ±‚ï¼š</strong>1~80å­—ï¼ˆåŒ…å«æ ‡ç‚¹ï¼‰</li>
                            <li><strong>æäº¤æ ¼å¼ï¼š</strong>ä½ çš„åå­—+å¥å­å†…å®¹+æ˜¯å¦åŸåˆ›ï¼ˆ+è‹¥éåŸåˆ›ï¼Œæ ‡æ˜å‡ºå¤„ï¼‰</li>
                            <li><strong>æäº¤æ–¹å¼ï¼š</strong>å†™åœ¨ä¾¿åˆ©è´´ä¸Šäº¤ç»™TQC</li>
                        </ul>
                        <p class="announcement-footnote">æœ€ç»ˆè§£é‡Šæƒå½’TQCæ‰€æœ‰</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é‡‘å¥é€‰æ‹©æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="phraseModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>é€‰æ‹©é‡‘å¥</h3>
                <span class="close-btn" id="closePhrase">&times;</span>
            </div>
            <div class="text-content" id="phraseList"></div>
        </div>
    </div>

    <!-- å¯»ç‰©æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="lostAndFoundModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>å¯»ç‰©</h3>
                <div style="display: flex; align-items: center;">
                    <span class="maximize-btn" id="maximizeLostAndFound">â›¶</span>
                    <span class="close-btn" id="closeLostAndFound">&times;</span>
                </div>
            </div>
            <div class="notification-container" style="display: flex; flex-direction: column; height: 100%;">
                <div class="big-title" style="
                    background: linear-gradient(135deg, #FF0000 0%, #FF6B00 25%, #FFD700 50%, #FF6B00 75%, #FF0000 100%);
                    -webkit-background-clip: text;
                    background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-size: 200% 200%;
                    animation: gradient-pulse 4s ease infinite;
                    text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 10px rgba(255,107,0,0.5);
                    font-size: 120px;
                    font-family: STXingkai, cursive;
                    letter-spacing: 4px;
                    width: 100%;
                    text-align: center;
                    margin: -8px 0 0;
                    padding: 0;
                    line-height: 1.2;
                ">å¯»ç‰©</div>
                
                <div class="announcement-content" id="lostAndFoundList" style="flex: 1; overflow-y: auto; padding: 10px;">
                    <div class="add-button">+</div>
                </div>
                
                <div class="notification-footer" style="position: sticky; bottom: 0; background: white; z-index: 10; padding: 10px 15px; border-top: 1px solid #eee;">
                    <div class="font-size-control">
                        <span class="font-size-label">å­—ä½“å¤§å°:</span>
                        <input type="range" id="lostAndFoundFontSizeSlider" min="12" max="120" value="28">
                        <input type="number" id="lostAndFoundFontSizeValue" min="12" max="120" value="28">
                        <span>px</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="notificationModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>é€šçŸ¥</h3>
                <div style="display: flex; align-items: center;">
                    <span class="maximize-btn" id="maximizeNotification">â›¶</span>
                    <span class="close-btn" id="closeNotification">&times;</span>
                </div>
            </div>
            <div class="notification-container">
                <div id="notificationContent">
                    <div class="empty-notification">æš‚æ— é€šçŸ¥ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ </div>
                </div>
                <div class="notification-footer">
                    <button class="add-notification-btn" id="addNotificationBtn">+ æ·»åŠ é€šçŸ¥</button>
                    <div class="font-size-control">
                        <span class="font-size-label">å­—ä½“å¤§å°:</span>
                        <input type="range" id="fontSizeSlider" min="12" max="120" value="16">
                        <input type="number" id="fontSizeValue" min="12" max="120" value="16">
                        <span>px</span>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <script>
        // Part1 æ—¶é—´é—´éš”è®¾ç½®
        let intervalDuration = 15 * 1000;
        let phraseTimer = null;

        // æ»‘åŠ¨æ¡å’Œè¾“å…¥æ¡†äº‹ä»¶
        document.getElementById('intervalSlider').addEventListener('input', function(e) {
            const value = Math.min(120, Math.max(1, parseInt(e.target.value) || 15));
            intervalDuration = value * 1000;
            document.getElementById('intervalValue').value = value;
            // å¦‚æœè‡ªåŠ¨è½®æ’­å¼€å¯åˆ™ç«‹å³åº”ç”¨æ–°é—´éš”
            if (goldenSwitch.checked && phraseTimer) {
                clearInterval(phraseTimer);
                phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            }
        });

        document.getElementById('intervalValue').addEventListener('input', function(e) {
            const value = Math.min(120, Math.max(1, parseInt(e.target.value) || 15));
            intervalDuration = value * 1000;
            document.getElementById('intervalSlider').value = value;
        });

        // é‡ç½®é—´éš”
        function resetInterval() {
            intervalDuration = 15 * 1000;
            document.getElementById('intervalSlider').value = 15;
            document.getElementById('intervalValue').value = 15;
            
            if (goldenSwitch.checked && phraseTimer) {
                clearInterval(phraseTimer);
                phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            }
        }

        // Part2 æ¦‚ç‡æ§åˆ¶
        let apiProbability = 50;

        // æ»‘åŠ¨æ¡è¾“å…¥äº‹ä»¶ç›‘å¬
        document.getElementById('apiProbability').addEventListener('input', function(e) {
            const value = Math.min(100, Math.max(0, parseInt(e.target.value) || 0));
            apiProbability = value;
            document.getElementById('apiProbabilityValue').value = value;
        });

        // æ•°å€¼è¾“å…¥æ¡†äº‹ä»¶ç›‘å¬
        document.getElementById('apiProbabilityValue').addEventListener('input', function(e) {
            const value = Math.min(100, Math.max(0, parseInt(e.target.value) || 0));
            apiProbability = value;
            document.getElementById('apiProbability').value = value;
        });

        // é‡ç½®æŒ‰é’®
        function resetProbability() {
            apiProbability = 50;
            document.getElementById('apiProbability').value = 50;
            document.getElementById('apiProbabilityValue').value = 50;
        }

        // Part3 å…¬å‘Šæ¿
        const announcementButton = document.getElementById('announcementButton');
        const announcementModal = document.getElementById('announcementModal');
        const closeAnnouncement = document.getElementById('closeAnnouncement');

        // æ‰“å¼€å…¬å‘Š
        announcementButton.addEventListener('click', () => {
            announcementModal.classList.add('active');
        });

        // å…³é—­å…¬å‘Š
        closeAnnouncement.addEventListener('click', () => {
            announcementModal.classList.remove('active');
        });

        // Part4 æ›´æ–°æ—¥å¿—åŠŸèƒ½
        const changelogButton = document.getElementById('changelogButton');
        const changelogModal = document.getElementById('changelogModal');
        const closeChangelog = document.getElementById('closeChangelog');

        // æ‰“å¼€æ›´æ–°æ—¥å¿—
        changelogButton.addEventListener('click', () => {
            changelogModal.classList.add('active');
        });

        // å…³é—­æ›´æ–°æ—¥å¿—
        closeChangelog.addEventListener('click', () => {
            changelogModal.classList.remove('active');
        });

        // Part5 è®¾ç½®
        const settingsButton = document.getElementById('settingsButton');
        const settingsModal = document.getElementById('settingsModal');
        const closeButton = document.getElementById('closeSettings');

        // æ‰“å¼€è®¾ç½®
        settingsButton.addEventListener('click', () => {
            settingsModal.classList.add('active');
        });

        // å…³é—­è®¾ç½®
        closeButton.addEventListener('click', () => {
            settingsModal.classList.remove('active');
        });

        // Part6 ä½œæ¯æ˜¾ç¤ºåŠŸèƒ½
        // æ—¶é—´è½¬æ¢å‡½æ•°
        function timeToMinutes(time) {
            if (time instanceof Date) {
                return time.getHours() * 60 + time.getMinutes();
            }
            if(time === "23:59") return 1439;
            const [h, m] = time.split(':').map(Number);
            return h * 60 + m;
        }

        // è·å–å½“å‰ä½œæ¯
        function getCurrentSchedule() {
            const now = new Date();
            const day = now.getDay();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            // å¦‚æœæ˜¯å‘¨æœ«
            if(day === 0 || day === 6) return {current: "å‘¨æœ«", nextLesson: ""};
            const todaySchedule = (day === 5) ? schedule.friday : schedule.weekday;
            let current = "";
            let nextLesson = "";
            // å¤„ç†è·¨å¤©æ—¶æ®µï¼ˆ22:20-7:00ï¼‰
            if(currentMinutes >= timeToMinutes("22:20") || currentMinutes < timeToMinutes("7:00")) {
                current = "æ´—æ¼±ç¡è§‰";
                nextLesson = "æ— ";  // æ˜ç¡®è®¾ç½®ä¸º"æ— "
                return {current, nextLesson};  // ç›´æ¥è¿”å›ï¼Œä¸æŸ¥æ‰¾ä¸‹èŠ‚è¯¾
            }
            // æŸ¥æ‰¾å½“å‰æ—¶é—´æ®µ
            let currentIndex = -1;
            for(let i = 0; i < todaySchedule.length; i++) {
                const [start, end] = todaySchedule[i][0].split('-');
                const startTime = timeToMinutes(start);
                const endTime = timeToMinutes(end);
                if(currentMinutes >= startTime && currentMinutes < endTime) {
                    current = todaySchedule[i][1];
                    currentIndex = i;
                    break;
                }
            }
            // æŸ¥æ‰¾ä¸‹ä¸€ä¸ª"èŠ‚è¯¾"
            if(currentIndex >= 0) {
                for(let i = currentIndex + 1; i < todaySchedule.length; i++) {
                    if(todaySchedule[i][1].endsWith("èŠ‚è¯¾") || todaySchedule[i][1].endsWith("è€ƒè¯•")) {
                        nextLesson = todaySchedule[i][1];
                        break;
                    }
                }
                // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¸‹èŠ‚è¯¾ï¼Œåˆ™è®¾ç½®ä¸º"æ— "
                if(!nextLesson) {
                    nextLesson = "æ— ";
                }
            }
            return {current, nextLesson};
        }

        // è·å–è¯¾ç¨‹åç§°
        function getCourseName(day, lessonIndex) {
            const days = ["sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday"];
            const timetableDay = timetable[days[day]];
            return timetableDay ? timetableDay[lessonIndex] : "";
        }

        // æ›´æ–°ä½œæ¯æ˜¾ç¤º
        function updateScheduleDisplay() {
            const now = new Date();
            const day = now.getDay();  
            const {current, nextLesson} = getCurrentSchedule();
            
            // å½“å‰ä½œæ¯
            let currentText = current;
            if(current.includes(" è¯¾")) {
                const lessonItems = schedule.weekday.filter(item => 
                    item[1].endsWith("èŠ‚è¯¾") || item[1].endsWith("è€ƒè¯•"));
                const currentLessonIndex = lessonItems.findIndex(item => item[1] === current);
                if(currentLessonIndex >=0 && currentLessonIndex <9) {
                    currentText = getCourseName(day, currentLessonIndex);
                }
            }
            document.getElementById('currentSchedule').textContent = currentText;
            
            // ä¸‹èŠ‚è¯¾
            let nextText = nextLesson;
            if(nextLesson) {
                const lessonItems = schedule.weekday.filter(item => 
                    item[1].endsWith("èŠ‚è¯¾") || item[1].endsWith("è€ƒè¯•"));
                const nextLessonIndex = lessonItems.findIndex(item => item[1] === nextLesson);
                if(nextLessonIndex >=0 && nextLessonIndex <9) {
                    nextText = getCourseName(day, nextLessonIndex);
                }
            }
            document.getElementById('nextSchedule').textContent = nextText || "æ— ";
            
            // è¯¾è¡¨
            if(day >=1 && day <=5) {
                const courses = timetable[Object.keys(timetable)[day-1]];
                document.getElementById('todayTimetable').innerHTML = courses.map((c,i) => 
                    `<div class="timetable-item">${i+1}&nbsp;${c}</div>`
                ).join('');
            } else {
                document.getElementById('todayTimetable').innerHTML = 
                    '<div class="timetable-item">å‘¨æœ«æ— è¯¾è¡¨</div>';
            }
        }

        // Part6.1 ä½œæ¯å€’è®¡æ—¶åŠŸèƒ½
        function getNextScheduleInfo() {
            const now = new Date();
            const day = now.getDay();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            const todaySchedule = (day === 5) ? schedule.friday : schedule.weekday;
            const { current } = getCurrentSchedule();

            if (current === "æ”¾å­¦" || day === 0 || day === 6) {
                return getNextSchoolDayTime(now);
            }

            if (current === "åˆä¼‘") {
                const inFirstPart = currentMinutes < timeToMinutes("13:10");
                return {
                    endTime: inFirstPart ? "13:10" : "13:40",
                    label: inFirstPart ? "ç†„ç¯" : "èµ·åºŠ"
                };
            }

            let currentIndex = todaySchedule.findIndex(([timeRange]) => {
                const [start, end] = timeRange.split('-');
                return currentMinutes >= timeToMinutes(start) && 
                       currentMinutes < timeToMinutes(end);
            });

            if (current === "è¯¾é—´") {
                const currentRange = todaySchedule[currentIndex][0];
                if (currentRange === "13:50-14:00") return { endTime: "14:00", label: "è¯¾å‰å”±ç»“æŸ" };
                if (currentRange === "15:30-15:40") return { endTime: "15:40", label: "è€ƒå‰å‡†å¤‡" };
                return { 
                    endTime: todaySchedule[currentIndex][0].split('-')[1], 
                    label: "ä¸Šè¯¾" 
                };
            }

            const labelMap = {
                "æ—©é¤": "æ—©è¯»å¼€å§‹",
                "æ—©è¯»": "æ—©è¯»ç»“æŸ",
                "åˆé¤": "åˆä¼‘é™æ ¡",
                "æ”¿å²èƒŒè®°": "æ™šè‡ªä¹ å¼€å§‹",
                "è€ƒå‰å‡†å¤‡": "è€ƒè¯•å¼€å§‹",
                "è€ƒè¯•": "è€ƒè¯•ç»“æŸ",
                "æ™šé¤": "æ”¿å²èƒŒè®°å¼€å§‹",
                "æ´—æ¼±ç¡è§‰": "èµ·åºŠ"
            };

            if (current.includes("èŠ‚è¯¾")) {
                const nextEvent = todaySchedule[currentIndex + 1]?.[1] || "";
                return {
                    endTime: todaySchedule[currentIndex][0].split('-')[1],
                    label: nextEvent.includes("è¯¾é—´") ? "ä¸‹è¯¾" : "ä¼‘æ¯"
                };
            }

            const nextIndex = currentIndex + 1;
            if (nextIndex < todaySchedule.length) {
                return {
                    endTime: todaySchedule[nextIndex][0].split('-')[0],
                    label: labelMap[current] || todaySchedule[nextIndex][1]
                };
            }

            return { endTime: "23:59", label: "æ–°çš„ä¸€å¤©" };
        }

        function getNextSchoolDayTime(now) {
            const target = new Date(now);
            let daysUntilMonday = (1 + 7 - target.getDay()) % 7; 
            if (target.getDay() === 1 && target.getHours() < 7) daysUntilMonday = 0;
            target.setDate(target.getDate() + daysUntilMonday);
            target.setHours(7, 0, 0, 0);
            return { endTime: target, label: "å‘¨ä¸€è¿”æ ¡" };
        }

        function updateCountdownDisplay() {
            const result = getNextScheduleInfo();
            const now = new Date();
            let target, label;

            if (result.endTime instanceof Date) {
                target = result.endTime;
                label = result.label;
            } else {
                label = result.label;
                const [endHour, endMinute] = result.endTime.split(':').map(Number);
                target = new Date(now);
                target.setHours(endHour, endMinute, 0, 0);
                if (target < now) target.setDate(target.getDate() + 1);
            }

            let diff = target - now;
            if (diff < 0) diff = 0;
            
            const seconds = Math.floor(diff / 1000);
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;

            // å…³é”®ä¿®æ”¹ç‚¹ï¼šä½¿ç”¨æ­£ç¡®çš„IDé€‰æ‹©å™¨
            const timerElement = document.getElementById('countdownTimer');
            const labelElement = document.getElementById('countdownName');

            // æ›´æ–°æ˜¾ç¤ºæ ¼å¼
            labelElement.textContent = `è·ç¦»${label}è¿˜æœ‰ï¼š`;
            
            if (h > 0) {
                timerElement.textContent = 
                    `${h.toString().padStart(2, '0')}:` +
                    `${m.toString().padStart(2, '0')}:` +
                    `${s.toString().padStart(2, '0')}`;
            } else {
                timerElement.textContent = 
                    `${m.toString().padStart(2, '0')}:` +
                    `${s.toString().padStart(2, '0')}`;
            }

            setTimeout(updateCountdownDisplay, 1000);

            // å‘¨ä¸€è¿”æ ¡å¼ºåˆ¶åˆ·æ–°é€»è¾‘
            if (diff <= 0 && label === "å‘¨ä¸€è¿”æ ¡") {
                setTimeout(() => {
                    location.reload();
                }, 1000);
            }
        }

        // Part7 é‡‘å¥åŠŸèƒ½
        const apiConfigs = [
            {
                url: 'https://zj.v.api.aa1.cn/api/wenan-shici/?type=json',
                method: 'GET',
                weight: 15,
                maxRetry: 3, // æœ€å¤§é‡è¯•æ¬¡æ•°
                handler: (data) => {
                    const text = data.msg || '';
                    return text.length <= 100 ? text : null;
                }
            },
            {
                url: 'https://api.songzixian.com/api/daily-poem?dataSource=LOCAL_DAILY_POEM',
                method: 'GET',
                weight: 15,
                maxRetry: 3,
                handler: (data) => {
                    if (!data.data) return null;
                    
                    // å¤„ç†æ ‡é¢˜æ ¼å¼
                    let title = data.data.title;
                    // å»é™¤æ ‡é¢˜ä¸­çš„ç©ºæ ¼ç‚¹å·
                    title = title.replace(/\s*Â·\s*/g, 'Â·');
                    // åˆ¤æ–­æ˜¯å¦éœ€è¦æ·»åŠ ä¹¦åå·
                    const hasBookMarks = /^ã€Š(.+)ã€‹$/.test(title);
                    const formattedTitle = hasBookMarks ? title : `ã€Š${title}ã€‹`;
                    
                    return `${data.data.quotes}â€”â€”${data.data.author}${formattedTitle}`;
                }
            },
            {
                url: 'https://zj.v.api.aa1.cn/api/wenan-wm/?type=json',
                method: 'GET',
                weight: 20,
                maxRetry: 3,
                handler: (data) => {
                    const text = data.msg || '';
                    return text.length <= 100 ? text : null;
                }
            },
            {
                url: 'https://zj.v.api.aa1.cn/api/wenan-mj/?type=json',
                method: 'GET',
                weight: 30,
                maxRetry: 3,
                handler: (data) => {
                    const text = data.msg || '';
                    return text.length <= 100 ? text : null;
                }
            },
            {
                url: 'https://api.mu-jie.cc/stray-birds/range?type=json',
                method: 'GET',
                weight: 20,
                maxRetry: 5,
                handler: (data) => {
                    const chLength = data.cn?.length || 0;
                    const enLength = data.en?.length || 0;
                    // ä¸­æ–‡è¶…é•¿ç›´æ¥è¿”å›nullè§¦å‘é‡è¯•
                    if (chLength > 100) return null;
                    // è®¡ç®—æ€»é•¿åº¦ï¼šè‹±æ–‡æŒ‰0.5å€è®¡ç®—
                    const totalLength = (enLength * 0.5) + chLength;
                    if (totalLength <= 100) {
                        return `${data.en}ï¼ˆ${data.cn}ï¼‰â€”â€”æ³°æˆˆå°”`;
                    }
                    // ä»…æ˜¾ç¤ºä¸­æ–‡
                    return `${data.cn}â€”â€”æ³°æˆˆå°”`;
                }
            }
        ];

        let currentApiIndex = 0;

        async function fetchWithRetry(apiConfig, retryCount = 0) {
            try {
                const response = await fetch(apiConfig.url, { method: apiConfig.method });
                if (!response.ok) throw new Error('HTTP error');
                
                const data = await response.json();
                const processed = apiConfig.handler(data);
                
                if (processed !== null) return processed;
                if (retryCount < apiConfig.maxRetry) {
                    return fetchWithRetry(apiConfig, retryCount + 1);
                }
                throw new Error('è¶…å‡ºæœ€å¤§é‡è¯•æ¬¡æ•°');
            } catch (error) {
                if (retryCount < apiConfig.maxRetry) {
                    return fetchWithRetry(apiConfig, retryCount + 1);
                }
                throw error;
            }
        }

        function selectRandomAPI() {
            const totalWeight = apiConfigs.reduce((sum, api) => sum + api.weight, 0);
            let random = Math.random() * totalWeight;
            
            for (const api of apiConfigs) {
                if (random < api.weight) {
                    return api;
                }
                random -= api.weight;
            }
            return apiConfigs[0];
        }

        async function fetchGoldenPhrase() {
            if (Math.random() < apiProbability / 100) {
                try {
                    const selectedAPI = selectRandomAPI();
                    const text = await fetchWithRetry(selectedAPI);
                    updatePhraseDisplay(text);
                } catch (error) {
                    console.warn('é‡‘å¥APIè·å–å¤±è´¥:', error);
                    showLocalPhrase();
                }
            } else {
                showLocalPhrase();
            }
        }

        function updatePhraseDisplay(text) {
            const container = document.getElementById('goldenPhrase');
            const animationEnabled = document.getElementById('animationSwitch').checked;
            const formattedText = text.replace(/\n/g, '<br>');
            if (animationEnabled) {
                container.style.opacity = 0;
                setTimeout(() => {
                    container.innerHTML = `ã€Œ ${formattedText} ã€`;
                    container.style.opacity = 1;
                }, 500);
            } else {
                container.innerHTML = `ã€Œ ${formattedText} ã€`;
                container.style.opacity = 1;
            }
        }

        // åŠ¨ç”»å¼€å…³äº‹ä»¶ç›‘å¬
        document.getElementById('animationSwitch').addEventListener('change', function() {
            const goldenPhrase = document.getElementById('goldenPhrase');
            if (this.checked) {
                goldenPhrase.classList.remove('no-animation');
            } else {
                goldenPhrase.classList.add('no-animation');
            }
        });

        let lastPhrase = null;

        function showLocalPhrase() {
            const showOriginalOnly = document.getElementById('originalSwitch').checked;

            const filterOriginal = arr => showOriginalOnly ? 
                arr.filter(p => p.trim().endsWith('ğŸŒŸ')) : 
                arr;

            const filtered = {
                high: filterOriginal(localPhrases.high),
                medium: filterOriginal(localPhrases.medium),
                low: filterOriginal(localPhrases.low)
            };

            if (showOriginalOnly) {
                const allOriginal = [
                    ...filtered.high,
                    ...filtered.medium,
                    ...filtered.low
                ].filter(p => p !== lastPhrase);


                if (allOriginal.length === 0) {
                    const fallbackList = [
                        ...filtered.high,
                        ...filtered.medium,
                        ...filtered.low
                    ];
                    if (fallbackList.length === 0) {
                        return updatePhraseDisplay("ğŸ¯ æ²¡æœ‰åŸåˆ›é‡‘å¥");
                    }
                    const selected = fallbackList[Math.floor(Math.random() * fallbackList.length)];
                    lastPhrase = selected;
                    return updatePhraseDisplay(selected);
                }

                const selected = allOriginal[Math.floor(Math.random() * allOriginal.length)];
                lastPhrase = selected;
                return updatePhraseDisplay(selected);
            } else {
                const weights = {
                    high: filtered.high.length ? 45 : 0,
                    medium: filtered.medium.length ? 35 : 0,
                    low: filtered.low.length ? 20 : 0
                };

                const totalWeight = weights.high + weights.medium + weights.low;
                if(totalWeight === 0) return updatePhraseDisplay("ğŸ¯ æ²¡æœ‰æ‰¾åˆ°é‡‘å¥");

                const buildPool = (list, weight) => {
                    if(!weight || !list.length) return [];
                    
                    const validList = list.filter(p => p !== lastPhrase);
                    const finalList = validList.length > 0 ? validList : list;
                    
                    return finalList.map(p => ({
                        p,
                        w: weight / finalList.length
                    }));
                };

                const pool = [
                    ...buildPool(filtered.high, weights.high),
                    ...buildPool(filtered.medium, weights.medium),
                    ...buildPool(filtered.low, weights.low)
                ];

                let random = Math.random() * totalWeight;
                let accumulated = 0;
                let selectedPhrase = pool[0]?.p || "ğŸ² é‡‘å¥åŠ è½½ä¸­...";
                
                for(const item of pool) {
                    accumulated += item.w;
                    if(random <= accumulated) {
                        selectedPhrase = item.p;
                        break;
                    }
                }

                lastPhrase = selectedPhrase;
                return updatePhraseDisplay(selectedPhrase);
            }
        }

        // Part8 äºŒåå››èŠ‚æ°”æ—¶é—´è½´
        // ç”ŸæˆèŠ‚æ°”æ ‡è®° 
        function generateSolarMarkers() {
            const springStart = solarTerms.find(t  => t.name  === 'ç«‹æ˜¥');
            const startDate = new Date(2025, springStart.month,  springStart.day); 
            const endDate = new Date(2025, 5, 18);
            const totalDays = (endDate - startDate) / 86400000;
            document.querySelectorAll('.solar-term-marker').forEach(m  => m.remove()); 
            solarTerms.forEach(term  => {
                const termDate = new Date(2025, term.month,  term.day); 
                if (termDate < startDate || termDate > endDate) return;
                const position = ((termDate - startDate) / 86400000 / totalDays) * 100;
                const isPast = termDate < new Date();
                const marker = document.createElement('div'); 
                marker.className  = 'solar-term-marker';
                marker.style.left  = `${position}%`;
                marker.innerHTML  = `
                    <div style="color: ${isPast ? '#666' : term.color}; 
                        font-weight: ${isPast ? 'normal' : '600'};
                        text-shadow: ${isPast ? 'none' : '0 2px 4px rgba(0,0,0,0.1)'}">
                        ${term.name} 
                    </div>
                    <div style="font-size:0.9em; color: ${isPast ? '#999' : '#666'};
                        margin-top: 5px">
                        ${termDate.getMonth()+1}  æœˆ${termDate.getDate()}  æ—¥ 
                    </div>
                `;
                marker.addEventListener('mouseover',  () => {
                    if (!isPast) {
                        marker.style.transform  = 'translateX(-50%) scale(1.1)';
                        // marker.style.filter  = 'drop-shadow(0 4px 6px rgba(0,0,0,0.15))';
                    }
                });
                marker.addEventListener('mouseout',  () => {
                    marker.style.transform  = 'translateX(-50%) scale(1)';
                    marker.style.filter  = 'none';
                });
                timeline.appendChild(marker); 
                // åˆ›å»ºå¡ç‰‡
                const card = document.createElement('div');
                card.className = 'solar-card';
                card.innerHTML = `
                    <h3>${term.name}</h3>
                    <img src="${term.image}" alt="${term.name}">
                    <p>${term.desc}</p>
                `;
                marker.appendChild(card);
                // ç‚¹å‡»äº‹ä»¶å¤„ç†
                marker.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const allCards = document.querySelectorAll('.solar-card');
                    allCards.forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                });
            });
            // ç‚¹å‡»å…¶ä»–åŒºåŸŸéšè—å¡ç‰‡
            document.addEventListener('click', () => {
                document.querySelectorAll('.solar-card').forEach(c => c.classList.remove('active'));
            });
        }

        // æ—¶é—´è½´
        function updateTimelineColor() {
            const springStart = solarTerms.find(t  => t.name  === 'ç«‹æ˜¥');
            const startDate = new Date(2025, springStart.month,  springStart.day); 
            const endDate = new Date(2025, 5, 18);
            const now = new Date();
            const total = endDate - startDate;
            const progress = Math.min(1,  Math.max(0,  (now - startDate) / total));
            timeline.style.setProperty('--progress-percent',  `${progress * 100}%`);
            requestAnimationFrame(updateTimelineColor);
        }

        // Part9 ä¸­è€ƒå€’è®¡æ—¶
        function updateCountdown() {
            const target = new Date(2025, 5, 18);
            const diff = target - new Date();
            const days = Math.max(0,  Math.ceil(diff  / 86400000));
            document.getElementById('daysUntil').textContent  = `${days}å¤©`;

            const now = new Date();
            const msToNextDay = 86400000 - (now % 86400000);
            setTimeout(updateCountdown, msToNextDay);
        }

        // Part10 æ—¶é’Ÿæ˜¾ç¤º
        function updateClock() {
            const date = new Date();
            const weekDays = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];
            // æ—¶é—´éƒ¨åˆ† 
            const hh = date.getHours().toString().padStart(2,  '0');
            const mm = date.getMinutes().toString().padStart(2,  '0');
            const ss = date.getSeconds().toString().padStart(2,  '0');
            // æ—¥æœŸéƒ¨åˆ† 
            const yyyy = date.getFullYear(); 
            const m = (date.getMonth()  + 1).toString().padStart(2, '0');
            const d = date.getDate().toString().padStart(2,  '0');
            const week = weekDays[date.getDay()];
            document.getElementById('currentDateTime').innerHTML  = `
                <div class="time-section">${hh}:${mm}:${ss}</div>
                <div class="date-section">${yyyy}/${m}/${d} å‘¨${week}</div>
            `;
            requestAnimationFrame(updateClock);
        }

        function fetchAndDisplayImage(url) {
            fetch('https://api.cenguigui.cn/api/60s/')
                .then(response => response.blob()) 
                .then(blob => {
                    const img = document.getElementById('apiImage'); 
                    img.src  = URL.createObjectURL(blob); 
                    img.style.height  = '80vh';
                })
                .catch(error => console.error(' å›¾ç‰‡åŠ è½½å¤±è´¥:', error));
        }

        // Part11 é‡‘å¥è‡ªåŠ¨è½®æ’­å’Œæ˜¾ç¤ºæ¯æ—¥60så¼€å…³
        // åˆå§‹åŒ–å¼€å…³çŠ¶æ€
        const goldenSwitch = document.getElementById('goldenSwitch'); 
        const imageSwitch = document.getElementById('imageSwitch'); 
        const apiImage = document.getElementById('apiImage'); 

        // é‡‘å¥è‡ªåŠ¨è½®æ’­å¼€å…³
        goldenSwitch.addEventListener('change', function() {
            if (this.checked) {
                phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            } else {
                clearInterval(phraseTimer);
                phraseTimer = null;
            }
        });

        // æ˜¾ç¤ºæ¯æ—¥60så¼€å…³
        imageSwitch.addEventListener('change',  function() {
            if (this.checked)  {
                apiImage.style.display  = 'block';
                fetchAndDisplayImage();
                setInterval(fetchAndDisplayImage, 86400000);
            } else {
                apiImage.style.display  = 'none';
                clearInterval(imageUpdateInterval);
            }
        });

        // åˆå§‹åŒ–æ—¶è®¾ç½®é»˜è®¤çŠ¶æ€
        goldenSwitch.checked  = true; // é»˜è®¤å¼€å¯é‡‘å¥è‡ªåŠ¨è½®æ’­
        imageSwitch.checked  = true; // é»˜è®¤å¼€å¯æ¯æ—¥60sæ˜¾ç¤º

        // Part12 å¤©æ°”
        function fetchWeather() {
            fetch('https://v2.api-m.com/api/weather?city=%E5%B2%B3%E9%BA%93%E5%8C%BA')
                .then(response => {
                    if (!response.ok) throw new Error('ç½‘ç»œå“åº”å¼‚å¸¸');
                    return response.json();
                })
                .then(data => {
                if (data.code === 200) {
                    // è·å–å½“å‰æ˜ŸæœŸï¼ˆç¤ºä¾‹è¿”å›æ ¼å¼ï¼š"å‘¨äº”"ï¼‰
                    const weekDays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
                    const currentDay = 'å‘¨' + weekDays[new Date().getDay()];
                    // æŸ¥æ‰¾åŒ¹é…çš„å¤©æ°”æ•°æ®
                    const todayWeather = data.data.data.find(item => item.date === currentDay);
                    if (todayWeather) {
                        // æ ¼å¼åŒ–æ¸©åº¦æ˜¾ç¤ºï¼ˆ7-10â„ƒ â†’ 7~10â„ƒï¼‰
                        const tempRange = todayWeather.temperature.replace('-', '~');
                        document.getElementById('weatherInfo').textContent = 
                        `${todayWeather.weather} ${tempRange}`;
                    } else {
                        document.getElementById('weatherInfo').textContent = 'å¤©æ°”æ•°æ®å¼‚å¸¸';
                    }
                } else {
                    throw new Error(data.msg);
                }
                })
            .catch(error => {
                console.error('å¤©æ°”è·å–å¤±è´¥:', error);
                document.getElementById('weatherInfo').textContent = 'å¤©æ°”è·å–å¤±è´¥';
            });
        }

        window.onload  = function() {
            fetchAndDisplayImage();
        };

        // Part13 ç‚¹å‡»åˆ·æ–°é‡‘å¥åŠŸèƒ½
        document.getElementById('goldenPhrase').addEventListener('click', function() {
            const clickRefreshEnabled = document.getElementById('clickRefreshSwitch').checked;
            const autoRotateEnabled = document.getElementById('goldenSwitch').checked;
            const animationEnabled = document.getElementById('animationSwitch').checked;
            
            if (clickRefreshEnabled) {
                // å½“åŠ¨ç”»å…³é—­æ—¶ç›´æ¥æ˜¾ç¤ºæ–°å†…å®¹
                if (!animationEnabled) {
                    fetchGoldenPhrase();
                    return;
                }
                // ä¿ç•™åŸæœ‰ç¼©æ”¾åŠ¨ç”»
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                    fetchGoldenPhrase();
                }, 300);
                if (autoRotateEnabled && phraseTimer) {
                    clearInterval(phraseTimer);
                    phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
                }
            }
        });

        // Part14 é‡‘å¥é€‰æ‹©åŠŸèƒ½
        const phraseModal = document.getElementById('phraseModal');
        const closePhrase = document.getElementById('closePhrase');
        const phraseButton = document.getElementById('phraseSelectButton'); 

        // æ‰“å¼€é‡‘å¥é€‰æ‹©
        function populatePhraseList() {
            const allPhrases = [...localPhrases.high, ...localPhrases.medium, ...localPhrases.low];
            const phraseList = document.getElementById('phraseList');
            phraseList.innerHTML = '';
            const fragment = document.createDocumentFragment();
            allPhrases.forEach(phrase => {
                const div = document.createElement('div');
                div.className = 'phrase-item';
                div.innerHTML = phrase.replace(/\n/g, '<br>');
                div.addEventListener('click', function() {
                    this.classList.add('phrase-click-effect');
                    setTimeout(() => {
                        this.classList.remove('phrase-click-effect');
                    }, 400);
                    updatePhraseDisplay(phrase);
                    setTimeout(() => {
                        phraseModal.classList.remove('active');
                    }, 200);
                    if (goldenSwitch.checked) {
                        clearInterval(phraseTimer);
                        phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
                    }
                });
                fragment.appendChild(div);
            });
            phraseList.appendChild(fragment);
        }

        // ä¿®æ”¹æ‰“å¼€æ¨¡æ€æ¡†äº‹ä»¶
        phraseButton.addEventListener('click', () => {
            populatePhraseList();
            phraseModal.classList.add('active');
        });

        // å…³é—­é‡‘å¥é€‰æ‹©
        closePhrase.addEventListener('click', () => {
            phraseModal.classList.remove('active');
        });

        // Part15 å¯»ç‰©åŠŸèƒ½
        const lostAndFoundButton = document.getElementById('lostAndFoundButton');
        const lostAndFoundModal = document.getElementById('lostAndFoundModal');
        const closeLostAndFound = document.getElementById('closeLostAndFound');

        // æ‰“å¼€å¯»ç‰©æ¿
        lostAndFoundButton.addEventListener('click', () => {
            lostAndFoundModal.classList.add('active');
        });

        // å…³é—­å¯»ç‰©æ¿
        closeLostAndFound.addEventListener('click', () => {
            lostAndFoundModal.classList.remove('active');
        });

        // ç¼–è¾‘åŠŸèƒ½
        document.getElementById('lostAndFoundList').addEventListener('click', function(e) {
            const target = e.target;
            if (target.classList.contains('editable')) {
                const originalText = target.textContent;
                const input = document.createElement('input');
                input.className = 'edit-input';
                input.value = originalText;
                input.style.width = target.offsetWidth + 'px';
                
                input.addEventListener('blur', function() {
                    target.textContent = this.value;
                    target.style.display = 'inline';
                    input.remove();
                });

                input.addEventListener('input', function() {
                    this.style.width = (this.value.length * 20 + 30) + 'px';
                });

                target.style.display = 'none';
                target.parentNode.insertBefore(input, target);
                input.focus();
            }
        });

        // æ·»åŠ å¡ç‰‡åŠŸèƒ½
        document.querySelector('.add-button').addEventListener('click', () => {
            const newCard = document.createElement('div');
            newCard.className = 'announcement-card';
            newCard.innerHTML = `
                <div class="announcement-body" style="position:relative; text-align: center; font-family: STZhongsong, serif;">
                    <span class="editable" data-type="name" style="color: #1E90FF;">åŒå­¦</span>
                    <span class="static-text">çš„</span> <!-- ç§»é™¤äº†é¢œè‰²æ ·å¼ï¼Œä½¿ç”¨é»˜è®¤é»‘è‰² -->
                    <span class="editable" data-type="item" style="color: #1E90FF;">ç‰©å“</span>
                    <button class="delete-btn">åˆ é™¤</button>
                </div>
            `;
            document.getElementById('lostAndFoundList').appendChild(newCard);
            
            // ç«‹å³åº”ç”¨å½“å‰å­—ä½“å¤§å°
            const editables = newCard.querySelectorAll('.editable, .static-text');
            editables.forEach(item => {
                item.style.fontSize = `${lostAndFoundFontSize}px`;
            });
        });

        // åˆ é™¤åŠŸèƒ½ï¼ˆä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼‰
        document.getElementById('lostAndFoundList').addEventListener('click', function(e) {
            if (e.target.classList.contains('delete-btn')) {
                if (e.target.textContent === 'åˆ é™¤') {
                    e.target.textContent = 'ç¡®è®¤åˆ é™¤';
                    e.target.style.background = '#d32f2f';
                } else {
                    e.target.closest('.announcement-card').remove();
                }
            }
        });

        // é‡ç½®åˆ é™¤æŒ‰é’®çŠ¶æ€ï¼ˆå½“ç‚¹å‡»å…¶ä»–åœ°æ–¹æ—¶ï¼‰
        document.addEventListener('click', (e) => {
            if (!e.target.classList.contains('delete-btn')) {
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.textContent = 'åˆ é™¤';
                    btn.style.background = '#ff4444';
                });
            }
        });

        let lostAndFoundFontSize = 28;
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–é€šçŸ¥æ¿
            renderNotifications();
            
            // åˆå§‹åŒ–å¯»ç‰©æ¿å­—ä½“å¤§å°æ§åˆ¶
            const lostAndFoundFontSizeSlider = document.getElementById('lostAndFoundFontSizeSlider');
            const lostAndFoundFontSizeValue = document.getElementById('lostAndFoundFontSizeValue');
            
            if (lostAndFoundFontSizeSlider && lostAndFoundFontSizeValue) {
                // æ»‘å—äº‹ä»¶
                lostAndFoundFontSizeSlider.addEventListener('input', function() {
                    const size = parseInt(this.value);
                    updateLostAndFoundFontSize(size);
                });

                // è¾“å…¥æ¡†äº‹ä»¶
                lostAndFoundFontSizeValue.addEventListener('input', function() {
                    let value = parseInt(this.value) || 28;
                    if (value < 12) value = 12;
                    if (value > 120) value = 120;
                    updateLostAndFoundFontSize(value);
                });
                
                // åˆå§‹åŒ–å­—ä½“å¤§å°
                updateLostAndFoundFontSize(28);
            }
        });

        // æ›´æ–°å¯»ç‰©æ¿å­—ä½“å¤§å°çš„å‡½æ•°
        function updateLostAndFoundFontSize(size) {
            lostAndFoundFontSize = size;
            if (document.getElementById('lostAndFoundFontSizeSlider')) {
                document.getElementById('lostAndFoundFontSizeSlider').value = size;
            }
            if (document.getElementById('lostAndFoundFontSizeValue')) {
                document.getElementById('lostAndFoundFontSizeValue').value = size;
            }
            
            // åº”ç”¨å­—ä½“å¤§å°åˆ°æ‰€æœ‰å¯»ç‰©æ¡ç›®
            const items = document.querySelectorAll('#lostAndFoundList .editable, #lostAndFoundList .static-text');
            items.forEach(item => {
                item.style.fontSize = `${size}px`;
            });
        }

        // Part16 é€šçŸ¥åŠŸèƒ½
        const notificationButton = document.getElementById('notificationButton');
        const notificationModal = document.getElementById('notificationModal');
        const closeNotification = document.getElementById('closeNotification');
        const notificationContent = document.getElementById('notificationContent');
        const addNotificationBtn = document.getElementById('addNotificationBtn');
        const fontSizeSlider = document.getElementById('fontSizeSlider');
        const fontSizeValue = document.getElementById('fontSizeValue');
        
        // é€šçŸ¥æ•°æ® - åˆå§‹ä¸ºç©ºæ•°ç»„
        let notifications = [];
        
        // æ‰“å¼€é€šçŸ¥æ¨¡æ€æ¡†
        notificationButton.addEventListener('click', () => {
            notificationModal.classList.add('active');
            renderNotifications();
        });
        
        // å…³é—­é€šçŸ¥æ¨¡æ€æ¡†
        closeNotification.addEventListener('click', () => {
            notificationModal.classList.remove('active');
        });
        
        // åŠ¨æ€è°ƒæ•´textareaé«˜åº¦
        function adjustTextareaHeight(textarea) {
            // è®¾ç½®æœ€å°é«˜åº¦ä¸º100px
            const minHeight = 100;
            textarea.style.height = 'auto';
            const height = Math.max(minHeight, textarea.scrollHeight);
            textarea.style.height = height + 'px';
        }
        
        // æ¸²æŸ“é€šçŸ¥
        function renderNotifications() {
            notificationContent.innerHTML = '';
            
            if (notifications.length === 0) {
                notificationContent.innerHTML = '<div class="empty-notification">æš‚æ— é€šçŸ¥ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ </div>';
                return;
            }
            
            const currentFontSize = notificationContent.style.fontSize || '16px';
            
            notifications.forEach((text, index) => {
                const item = document.createElement('div');
                item.className = 'notification-item';
                item.dataset.index = index;
                const formattedText = text.replace(/\n/g, '<br>');
                item.innerHTML = formattedText;
                item.style.fontSize = currentFontSize;
                
                // æ·»åŠ åˆ é™¤æŒ‰é’®
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-notification-btn';
                deleteBtn.textContent = 'åˆ é™¤';
                deleteBtn.dataset.index = index;
                item.appendChild(deleteBtn);
                
                // åˆ é™¤æŒ‰é’®äº‹ä»¶ - ä¿®å¤äº‹ä»¶å†’æ³¡é—®é¢˜
                deleteBtn.addEventListener('click', function(e) {
                    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                    const index = this.dataset.index;
                    
                    if (this.textContent === 'åˆ é™¤') {
                        this.textContent = 'ç¡®è®¤åˆ é™¤';
                        this.style.background = '#d32f2f';
                    } else {
                        notifications.splice(index, 1);
                        renderNotifications();
                    }
                });
                
                // ç‚¹å‡»é€šçŸ¥è¿›å…¥ç¼–è¾‘æ¨¡å¼
                item.addEventListener('click', function(e) {
                    // å¦‚æœç‚¹å‡»çš„æ˜¯åˆ é™¤æŒ‰é’®åˆ™ä¸è¿›å…¥ç¼–è¾‘
                    if (e.target.classList.contains('delete-notification-btn')) return;
                    
                    const index = this.dataset.index;
                    const textarea = document.createElement('textarea');
                    textarea.className = 'notification-editable';
                    textarea.value = notifications[index];
                    textarea.style.fontSize = currentFontSize;
                    
                    // åˆå§‹é«˜åº¦è°ƒæ•´
                    adjustTextareaHeight(textarea);
                    
                    this.innerHTML = '';
                    this.appendChild(textarea);
                    textarea.focus();
                    
                    // è¾“å…¥æ—¶åŠ¨æ€è°ƒæ•´é«˜åº¦
                    textarea.addEventListener('input', function() {
                        adjustTextareaHeight(this);
                    });
                    
                    // ä¿®å¤ï¼šæ·»åŠ å¯¹Enteré”®çš„å¤„ç†
                    textarea.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            e.preventDefault();
                            // åœ¨å…‰æ ‡ä½ç½®æ’å…¥æ¢è¡Œç¬¦
                            const start = this.selectionStart;
                            const end = this.selectionEnd;
                            this.value = this.value.substring(0, start) + '\n' + this.value.substring(end);
                            this.selectionStart = this.selectionEnd = start + 1;
                            adjustTextareaHeight(this);
                        }
                    });
                    
                    textarea.addEventListener('blur', function() {
                        notifications[index] = this.value;
                        renderNotifications();
                    });
                });
                
                notificationContent.appendChild(item);
            });
        }
        
        // æ·»åŠ æ–°é€šçŸ¥
        addNotificationBtn.addEventListener('click', () => {
            notifications.push("æ–°é€šçŸ¥ - ç‚¹å‡»ç¼–è¾‘å†…å®¹");
            renderNotifications();
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            notificationContent.scrollTop = notificationContent.scrollHeight;
        });
        
        // å­—ä½“å¤§å°æ§åˆ¶
        fontSizeSlider.addEventListener('input', function() {
            const size = this.value + 'px';
            notificationContent.style.fontSize = size;
            fontSizeValue.value = this.value;
            renderNotifications();
        });
        
        fontSizeValue.addEventListener('input', function() {
            let value = parseInt(this.value) || 16;
            if (value < 12) value = 12;
            if (value > 120) value = 120;
            
            notificationContent.style.fontSize = value + 'px';
            fontSizeSlider.value = value;
            this.value = value;
            renderNotifications();
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨æ—¶é‡ç½®æ‰€æœ‰åˆ é™¤æŒ‰é’®
        document.addEventListener('click', (e) => {
            if (!e.target.classList.contains('delete-notification-btn')) {
                document.querySelectorAll('.delete-notification-btn').forEach(btn => {
                    btn.textContent = 'åˆ é™¤';
                    btn.style.background = '#ff4444';
                });
            }
        });

        // åˆå§‹åŒ–é€šçŸ¥
        document.addEventListener('DOMContentLoaded', () => {
            renderNotifications();
        });

        // Part17 çª—å£æœ€å¤§åŒ–
        // é€šçŸ¥æ¨¡æ€æ¡†æœ€å¤§åŒ–åŠŸèƒ½
        const maximizeNotification = document.getElementById('maximizeNotification');
        maximizeNotification.addEventListener('click', function() {
            const modal = document.getElementById('notificationModal');
            const content = modal.querySelector('.settings-content');
            
            if (modal.classList.contains('fullscreen')) {
                modal.classList.remove('fullscreen');
                this.textContent = 'â›¶';
            } else {
                modal.classList.add('fullscreen');
                this.textContent = 'ğŸ——';
            }
        });

        // å¯»ç‰©æ¨¡æ€æ¡†æœ€å¤§åŒ–åŠŸèƒ½
        const maximizeLostAndFound = document.getElementById('maximizeLostAndFound');
        maximizeLostAndFound.addEventListener('click', function() {
            const modal = document.getElementById('lostAndFoundModal');
            const content = modal.querySelector('.settings-content');
            
            if (modal.classList.contains('fullscreen')) {
                modal.classList.remove('fullscreen');
                this.textContent = 'â›¶';
            } else {
                modal.classList.add('fullscreen');
                this.textContent = 'ğŸ——';
            }
        });

        // å…³é—­æ¨¡æ€æ¡†æ—¶é‡ç½®å…¨å±çŠ¶æ€
        function resetFullscreen(modalId) {
            const modal = document.getElementById(modalId);
            if (modal.classList.contains('fullscreen')) {
                modal.classList.remove('fullscreen');
                const maximizeBtn = modal.querySelector('.maximize-btn');
                if (maximizeBtn) maximizeBtn.textContent = 'â›¶';
            }
        }

        // åœ¨å…³é—­é€šçŸ¥æ¨¡æ€æ¡†æ—¶è°ƒç”¨é‡ç½®
        closeNotification.addEventListener('click', () => {
            resetFullscreen('notificationModal');
            notificationModal.classList.remove('active');
        });

        // åœ¨å…³é—­å¯»ç‰©æ¨¡æ€æ¡†æ—¶è°ƒç”¨é‡ç½®
        closeLostAndFound.addEventListener('click', () => {
            resetFullscreen('lostAndFoundModal');
            lostAndFoundModal.classList.remove('active');
        });

        // Part18 è‡ªåŠ¨åˆ·æ–°
        // è·å–è‡ªåŠ¨åˆ·æ–°å¼€å…³å…ƒç´ 
        const autoRefreshSwitch = document.getElementById('autoRefreshSwitch');
        let refreshTimer = null; // åˆ·æ–°å®šæ—¶å™¨
        const REFRESH_INTERVAL = 15 * 60 * 1000; // 15åˆ†é’Ÿï¼ˆæ¯«ç§’ï¼‰

        // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            // æ¸…é™¤ç°æœ‰å®šæ—¶å™¨
            if (refreshTimer) clearTimeout(refreshTimer);
            
            // è®¾ç½®æ–°å®šæ—¶å™¨
            refreshTimer = setTimeout(() => {
                location.reload();
            }, REFRESH_INTERVAL);
        }

        // åœæ­¢è‡ªåŠ¨åˆ·æ–°
        function stopAutoRefresh() {
            if (refreshTimer) {
                clearTimeout(refreshTimer);
                refreshTimer = null;
            }
        }

        // ç›‘å¬å¼€å…³å˜åŒ–
        autoRefreshSwitch.addEventListener('change', function() {
            if (this.checked) {
                startAutoRefresh();
            } else {
                stopAutoRefresh();
            }
        });

        // é¡µé¢åŠ è½½æ—¶é»˜è®¤å¼€å¯è‡ªåŠ¨åˆ·æ–°
        window.addEventListener('DOMContentLoaded', () => {
            // é»˜è®¤å¼€å¯å¼€å…³
            autoRefreshSwitch.checked = true;
            // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
            startAutoRefresh();
        });

        // åœ¨é¡µé¢å¸è½½æ—¶æ¸…é™¤å®šæ—¶å™¨
        window.addEventListener('beforeunload', () => {
            if (refreshTimer) {
                clearTimeout(refreshTimer);
            }
        });

        // PartLast åˆå§‹åŒ– 
        function init() {
            // æ£€æµ‹æ˜¯å¦å·²ç»è¿‡äº†ä¸­è€ƒæ—¶é—´
            const examEndTime = new Date(2025, 5, 20, 10, 40); // 2025å¹´6æœˆ20æ—¥10:40
            const now = new Date();
            
            if (now >= examEndTime) {
                // ä¿®æ”¹æ ‡é¢˜
                document.querySelector('.small-title').textContent = 'ä¸‰å¹´å¯’çª—';
                
                // ä¿®æ”¹å¤©æ•°æ˜¾ç¤º
                const daysElement = document.getElementById('daysUntil');
                daysElement.textContent = 'æˆ‘ä»¬æ¯•ä¸šå•¦';
                daysElement.style.fontFamily = 'Ximai, STKaiti';
                daysElement.style.fontSize = '120px'; // é€‚å½“è°ƒæ•´å¤§å°
                daysElement.style.color = '#d32f2f'; // å–œåº†çš„çº¢è‰²
                daysElement.style.textShadow = '2px 2px 4px rgba(0,0,0,0.2)';
                
                // ä¿®æ”¹é‡‘å¥æ˜¾ç¤ºä¸ºæ¯•ä¸šç›¸å…³
                updatePhraseDisplay("ğŸ“ æ¯•ä¸šå¿«ä¹ï¼æ„¿æˆ‘ä»¬å‰ç¨‹ä¼¼é”¦ï¼Œæœªæ¥å¯æœŸï¼");
                return;
            }
            updateCountdown();
            updateClock();
            updateTimelineColor();
            generateSolarMarkers();
            fetchGoldenPhrase();
            phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            setInterval(updateScheduleDisplay, 1000);
            fetchWeather();
            setInterval(fetchWeather, 15000);
            updateCountdownDisplay();
        }

        init();

        window.addEventListener('unload',  () => clearInterval(phraseTimer));
        setInterval(() => {
            generateSolarMarkers();
            updateCountdown();
        }, 86400000);
    </script>



</body>
</html>
